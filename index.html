<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>La Rica Chicha - ASWA Unificado</title>
    
    <!-- Frameworks -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Bebas+Neue&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Firebase SDK (Configuraci√≥n Unificada) -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getFirestore, collection, addDoc, query, where, getDocs, serverTimestamp, doc, updateDoc } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";

        // NOTA: Reemplazar con tus credenciales reales o dejar las variables si usas el entorno de ASWA
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            apiKey: "TU_API_KEY",
            authDomain: "TU_DOMAIN",
            projectId: "TU_PROJECT_ID",
            storageBucket: "TU_BUCKET",
            messagingSenderId: "TU_SENDER",
            appId: "TU_APP_ID"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'aswa-laricachicha';

        window.db = db;
        window.appId = appId;
        window.query = query;
        window.where = where;
        window.getDocs = getDocs;
        window.collection = collection;

        signInAnonymously(auth).catch(e => console.error("Auth Error", e));
        onAuthStateChanged(auth, user => window.currentUser = user);

        window.saveOrder = async (data) => {
            if (!window.currentUser) return null;
            try {
                const ref = await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'pedidos'), {
                    ...data, fecha: serverTimestamp(), uid: window.currentUser.uid, compartido: false
                });
                return ref.id;
            } catch (e) { return null; }
        };

        window.marcarComoCompartido = async (id) => {
            if (!id) return;
            try { await updateDoc(doc(db, 'artifacts', appId, 'public', 'data', 'pedidos', id), { compartido: true }); } 
            catch (e) { console.warn(e); }
        };
    </script>

    <style>
        body { font-family: 'Poppins', sans-serif; background:#0a0a0b; color:white; -webkit-tap-highlight-color:transparent; }
        .font-bebas { font-family: 'Bebas Neue', cursive; }
        .logo-container { width:90px; height:90px; background:#000; border-radius:50%; display:flex; align-items:center; justify-content:center; box-shadow:0 0 30px rgba(250,204,21,0.4); border:3px solid #facc15; overflow:hidden; cursor:pointer; }
        .logo-container img { width:100%; height:100%; object-fit:contain; }
        .product-img-wrapper { width:100px; height:100px; background:#1a1a1a; border-radius:20px; border:1px solid #333; display:flex; align-items:center; justify-content:center; overflow:hidden; }
        .product-img-wrapper img { width:80%; height:80%; object-fit:contain; }
        .input-dark { background:#121214; border:1px solid #27272a; color:white; transition:all .3s; }
        .input-dark:focus { border-color:#facc15; background:#1a1a1c; outline:none; }
        .payment-option { border:2px solid #27272a; transition:all .2s; cursor:pointer; }
        .payment-option.active { border-color:#facc15 !important; background:rgba(250,204,21,0.15) !important; transform: scale(1.05); }
        .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.95); z-index:2000; flex-direction:column; align-items:center; justify-content:center; padding:20px; backdrop-filter:blur(10px); }
        .step-inactive { opacity: 0.5; pointer-events: none; }
        @keyframes pulse-yellow { 0% { box-shadow: 0 0 0 0 rgba(250,204,21,0.4); } 70% { box-shadow: 0 0 0 10px rgba(250,204,21,0); } 100% { box-shadow: 0 0 0 0 rgba(250,204,21,0); } }
        .btn-pulse { animation: pulse-yellow 2s infinite; }
    </style>
</head>
<body class="min-h-screen pb-48">

    <!-- Header Unificado -->
    <header class="fixed top-0 left-0 w-full bg-black/80 backdrop-blur-md z-50 border-b border-zinc-900 p-4">
        <div class="max-w-md mx-auto flex flex-col items-center">
            <div class="logo-container mb-2" onclick="handleLogoClick()">
                <img src="logo de aswa.jpg" alt="ASWA" onerror="this.src='https://via.placeholder.com/100?text=ASWA'">
            </div>
            <h1 class="font-bebas text-3xl text-yellow-400 tracking-widest">La Rica Chicha</h1>
            <p class="text-[10px] text-yellow-300/80 font-bold uppercase tracking-widest">el oro l√≠quido de la selva</p>
        </div>
    </header>

    <div class="h-40"></div>

    <main class="max-w-md mx-auto px-6 space-y-8">
        
        <!-- Alerta de Bienvenida Inteligente -->
        <div id="welcomeMsg" class="hidden animate-fade-in">
            <div class="bg-yellow-500/10 border border-yellow-500 p-4 rounded-2xl text-center">
                <p class="text-yellow-400 font-bold" id="welcomeText"></p>
            </div>
        </div>

        <!-- Secci√≥n Productos -->
        <section class="space-y-4">
            <h2 class="font-bold text-lg flex items-center gap-2">
                <span class="w-1.5 h-6 bg-yellow-500 rounded-full"></span> Elige tu presentaci√≥n
            </h2>
            
            <!-- Items de Carrito -->
            <div id="product-list" class="space-y-3">
                <!-- 2 Litros -->
                <div class="bg-zinc-900/50 p-4 rounded-3xl border border-zinc-800 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="product-img-wrapper"><img src="aswa de 2 litros 1.png" alt="2L"></div>
                        <div><p class="font-bold text-sm">2 Litros</p><p class="text-yellow-400 font-bebas text-xl">S/ 9.00</p></div>
                    </div>
                    <div class="flex items-center gap-3 bg-black/40 p-2 rounded-xl">
                        <button onclick="updateQty('p2l', -1)" class="w-8 h-8 text-zinc-500">-</button>
                        <span id="qty-p2l" class="font-bold w-4 text-center">0</span>
                        <button onclick="updateQty('p2l', 1)" class="w-8 h-8 bg-yellow-500 text-black rounded-lg font-bold">+</button>
                    </div>
                </div>
                <!-- 3 Litros -->
                <div class="bg-zinc-900/50 p-4 rounded-3xl border border-zinc-800 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="product-img-wrapper"><img src="aswa de 3 litros.png" alt="3L"></div>
                        <div><p class="font-bold text-sm">3 Litros</p><p class="text-yellow-400 font-bebas text-xl">S/ 13.00</p></div>
                    </div>
                    <div class="flex items-center gap-3 bg-black/40 p-2 rounded-xl">
                        <button onclick="updateQty('p3l', -1)" class="w-8 h-8 text-zinc-500">-</button>
                        <span id="qty-p3l" class="font-bold w-4 text-center">0</span>
                        <button onclick="updateQty('p3l', 1)" class="w-8 h-8 bg-yellow-500 text-black rounded-lg font-bold">+</button>
                    </div>
                </div>
                <!-- 4 Litros -->
                <div class="bg-zinc-900/50 p-4 rounded-3xl border border-yellow-500/20 flex items-center justify-between">
                    <div class="flex items-center gap-3">
                        <div class="product-img-wrapper border-yellow-500/30"><img src="galon familiar de 4 litros.png" alt="4L"></div>
                        <div><p class="font-bold text-sm">Gal√≥n 4L</p><p class="text-yellow-400 font-bebas text-xl">S/ 15.00</p></div>
                    </div>
                    <div class="flex items-center gap-3 bg-black/40 p-2 rounded-xl">
                        <button onclick="updateQty('p4l', -1)" class="w-8 h-8 text-zinc-500">-</button>
                        <span id="qty-p4l" class="font-bold w-4 text-center">0</span>
                        <button onclick="updateQty('p4l', 1)" class="w-8 h-8 bg-yellow-500 text-black rounded-lg font-bold">+</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Datos de Entrega con Autollenado -->
        <section class="space-y-4">
            <h2 class="font-bold text-lg flex items-center gap-2">
                <span class="w-1.5 h-6 bg-yellow-500 rounded-full"></span> Datos de entrega
            </h2>
            <div class="space-y-3">
                <input type="tel" id="telefono" placeholder="Celular (9 d√≠gitos)" maxlength="9" class="w-full p-4 rounded-2xl input-dark text-sm font-bold">
                <input type="text" id="nombre" placeholder="Nombre completo" class="w-full p-4 rounded-2xl input-dark text-sm">
                
                <select id="distrito" onchange="calculateTotal()" class="w-full p-4 rounded-2xl input-dark text-sm">
                    <option value="" disabled selected>Selecciona tu zona...</option>
                    <option value="3">Morales (S/3)</option>
                    <option value="4">Tarapoto (S/4)</option>
                    <option value="5">Banda de Shilcayo (S/5)</option>
                    <option value="0">Recojo en local (S/0)</option>
                </select>

                <textarea id="direccion" rows="2" placeholder="Direcci√≥n exacta y referencia" class="w-full p-4 rounded-2xl input-dark text-sm"></textarea>
                
                <div id="addressSuggestion" class="hidden">
                    <div class="bg-zinc-900 border border-zinc-700 p-3 rounded-2xl flex items-center justify-between">
                        <p class="text-[10px] text-zinc-400">¬øUsar direcci√≥n anterior?</p>
                        <button onclick="applyLastAddress()" class="text-xs text-yellow-500 font-bold uppercase">S√≠, usar esa</button>
                    </div>
                </div>

                <button onclick="getGPS()" id="gpsBtn" class="w-full py-4 rounded-2xl bg-gradient-to-r from-yellow-500 to-yellow-600 text-black font-black text-xs flex items-center justify-center gap-2 shadow-lg">
                    <i data-lucide="map-pin" class="w-4 h-4"></i> COMPARTIR UBICACI√ìN GPS
                </button>
            </div>
        </section>

        <!-- Pagos -->
        <section class="space-y-4">
            <h2 class="font-bold text-lg flex items-center gap-2">
                <span class="w-1.5 h-6 bg-yellow-500 rounded-full"></span> M√©todo de pago
            </h2>
            <div class="grid grid-cols-3 gap-2">
                <div onclick="setPayment('Efectivo')" id="pay-Efectivo" class="payment-option active bg-zinc-900 p-4 rounded-2xl flex flex-col items-center gap-2">
                    <i data-lucide="banknote" class="text-green-500"></i><span class="text-[10px] font-bold">Efectivo</span>
                </div>
                <div onclick="setPayment('Yape')" id="pay-Yape" class="payment-option bg-zinc-900 p-4 rounded-2xl flex flex-col items-center gap-2">
                    <div class="w-6 h-6 bg-purple-600 rounded flex items-center justify-center text-[10px] font-black">Y</div><span class="text-[10px] font-bold">Yape</span>
                </div>
                <div onclick="setPayment('Plin')" id="pay-Plin" class="payment-option bg-zinc-900 p-4 rounded-2xl flex flex-col items-center gap-2">
                    <div class="w-6 h-6 bg-cyan-500 rounded flex items-center justify-center text-[10px] font-black">P</div><span class="text-[10px] font-bold">Plin</span>
                </div>
            </div>
        </section>

        <!-- Mensaje de Local -->
        <div class="text-center opacity-50 py-4">
            <p class="text-[9px] uppercase tracking-[0.4em] mb-4">El sabor que une a nuestra familia</p>
            <a href="https://maps.google.com/?q=ASWA+Tarapoto" target="_blank" class="inline-flex items-center gap-2 text-xs font-bold border-b border-zinc-700 pb-1">
                <i data-lucide="map" class="w-3 h-3"></i> VIS√çTANOS EN NUESTRO LOCAL
            </a>
        </div>
    </main>

    <!-- Footer Flotante -->
    <footer class="fixed bottom-0 left-0 w-full bg-black/90 backdrop-blur-xl border-t border-zinc-800 p-6 z-50">
        <div class="max-w-md mx-auto">
            <div class="flex flex-col mb-4">
                <p id="label-normal" class="text-zinc-500 text-[10px] line-through hidden"></p>
                <p id="label-desc" class="text-green-500 text-xs font-bold hidden"></p>
            </div>
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-[10px] text-zinc-400 font-bold uppercase">Total a pagar</p>
                    <p id="display-total" class="text-4xl font-bebas text-yellow-500 tracking-wider">S/ 0.00</p>
                </div>
                <button onclick="openSummary()" class="bg-yellow-500 text-black px-8 py-4 rounded-2xl font-black btn-pulse flex items-center gap-2">
                    CONTINUAR <i data-lucide="chevron-right"></i>
                </button>
            </div>
        </div>
    </footer>

    <!-- Modal Resumen Unificado -->
    <div id="summaryModal" class="modal">
        <div class="bg-zinc-900 w-full max-w-sm rounded-[32px] p-8 border border-zinc-800 shadow-2xl relative">
            <h3 class="font-bebas text-3xl text-yellow-500 text-center mb-6 tracking-widest">RESUMEN DE PEDIDO</h3>
            
            <div id="summary-items" class="space-y-2 mb-6 text-sm text-zinc-300"></div>

            <!-- Zona de Pago Digital -->
            <div id="digital-area" class="hidden space-y-4 text-center border-t border-zinc-800 pt-4">
                <p class="text-xs text-zinc-400">Escanea o paga al n√∫mero:</p>
                <button onclick="copyNumber()" class="bg-zinc-800 px-4 py-2 rounded-xl text-yellow-500 font-bold text-sm">
                    986 445 531 <i data-lucide="copy" class="inline w-3 h-3 ml-1"></i>
                </button>
                <img src="yape del negocio.jpg" class="w-32 h-32 mx-auto rounded-2xl border-4 border-white">
                <button id="btnConfirmPay" onclick="confirmDigitalPayment()" class="w-full py-3 rounded-xl bg-zinc-800 text-xs font-bold border border-zinc-700">
                    YA REALIC√â EL PAGO
                </button>
            </div>

            <!-- Bot√≥n Final -->
            <button id="btnFinal" onclick="submitOrder()" class="w-full mt-6 py-4 rounded-2xl bg-yellow-500 text-black font-black text-lg shadow-xl flex items-center justify-center gap-2">
                ENVIAR PEDIDO <i data-lucide="send" class="w-5 h-5"></i>
            </button>
            
            <button onclick="closeModal()" class="w-full mt-4 text-zinc-500 text-[10px] uppercase font-bold tracking-widest">Volver</button>
        </div>
    </div>

    <!-- Pantalla √âxito Unificada -->
    <div id="successScreen" class="hidden fixed inset-0 bg-black z-[3000] flex flex-col items-center justify-center p-8 text-center">
        <div class="w-24 h-24 bg-green-500 rounded-full flex items-center justify-center mb-6 shadow-[0_0_50px_rgba(34,197,94,0.4)]">
            <i data-lucide="check" class="text-black w-12 h-12"></i>
        </div>
        <h2 class="font-bebas text-5xl text-yellow-500 mb-2">¬°PEDIDO ENVIADO!</h2>
        <p class="text-zinc-400 text-sm mb-8">Estamos preparando tu ASWA... <br> No olvides enviar la captura si pagaste con Yape/Plin.</p>
        
        <div class="bg-zinc-900 p-6 rounded-[32px] w-full max-w-xs border border-zinc-800 space-y-4 mb-8">
            <p class="text-xs font-bold text-yellow-500 uppercase">¬°Gana 5% extra en tu pr√≥ximo pedido!</p>
            <p class="text-[10px] text-zinc-500">Comparte en tus redes y haznos crecer ‚ù§Ô∏è</p>
            <div class="flex justify-center gap-4">
                <button onclick="shareSocial('fb')" class="p-4 bg-blue-600 rounded-2xl"><i data-lucide="facebook"></i></button>
                <button onclick="shareSocial('ig')" class="p-4 bg-gradient-to-tr from-yellow-500 via-pink-500 to-purple-600 rounded-2xl"><i data-lucide="instagram"></i></button>
            </div>
        </div>

        <button onclick="location.reload()" class="text-zinc-500 font-bold text-xs uppercase tracking-widest">Hacer otro pedido</button>
    </div>

    <script>
        lucide.createIcons();

        // Estado Global
        const cart = { p2l: 0, p3l: 0, p4l: 0 };
        let currentMethod = 'Efectivo';
        let confirmedDigital = false;
        let lastAddress = "";
        let finalTotal = 0;
        let discountInfo = { amount: 0, reason: "" };
        let gpsUrl = "";
        let debounceTimer;
        let clicksLogo = 0;

        function updateQty(id, change) {
            cart[id] = Math.max(0, cart[id] + change);
            document.getElementById(`qty-${id}`).innerText = cart[id];
            calculateTotal();
        }

        function setPayment(m) {
            currentMethod = m;
            document.querySelectorAll('.payment-option').forEach(el => el.classList.remove('active'));
            document.getElementById(`pay-${m}`).classList.add('active');
        }

        // --- L√≥gica de Fidelizaci√≥n y Debounce ---
        document.getElementById('telefono').addEventListener('input', (e) => {
            const tel = e.target.value;
            clearTimeout(debounceTimer);
            if (tel.length === 9) {
                debounceTimer = setTimeout(() => searchCustomer(tel), 500);
            }
        });

        async function searchCustomer(tel) {
            try {
                const q = window.query(window.collection(window.db, 'artifacts', window.appId, 'public', 'data', 'pedidos'), window.where('telefono', '==', tel));
                const snap = await window.getDocs(q);
                if (!snap.empty) {
                    const data = snap.docs.map(d => d.data());
                    const lastOrder = data.sort((a,b) => b.fecha?.seconds - a.fecha?.seconds)[0];
                    
                    // Autollenado
                    document.getElementById('nombre').value = lastOrder.nombre || "";
                    lastAddress = lastOrder.direccion || "";
                    if (lastAddress) document.getElementById('addressSuggestion').classList.remove('hidden');

                    // L√≥gica de Descuento (VIP/Frecuente)
                    let perc = 0;
                    let reason = "";
                    const count = data.length;
                    if (count >= 10) { perc = 0.15; reason = "Cliente VIP (15%)"; }
                    else if (count >= 5) { perc = 0.10; reason = "Cliente Fiel (10%)"; }
                    
                    const sharedCount = data.filter(p => p.compartido).length;
                    if (sharedCount >= 3) { perc += 0.05; reason += " + Bono Social (5%)"; }

                    discountInfo = { amount: perc, reason };
                    
                    const pName = lastOrder.nombre.split(' ')[0];
                    document.getElementById('welcomeText').innerText = `¬°Hola de nuevo, ${pName}! üòä`;
                    document.getElementById('welcomeMsg').classList.remove('hidden');
                    calculateTotal();
                }
            } catch (e) { console.error(e); }
        }

        function applyLastAddress() {
            document.getElementById('direccion').value = lastAddress;
            document.getElementById('addressSuggestion').classList.add('hidden');
        }

        function calculateTotal() {
            const subtotal = (cart.p2l * 9) + (cart.p3l * 13) + (cart.p4l * 15);
            const delivery = parseFloat(document.getElementById('distrito').value) || 0;
            const rawTotal = subtotal + delivery;
            
            finalTotal = rawTotal * (1 - discountInfo.amount);

            // UI
            document.getElementById('display-total').innerText = `S/ ${finalTotal.toFixed(2)}`;
            if (discountInfo.amount > 0) {
                document.getElementById('label-normal').innerText = `S/ ${rawTotal.toFixed(2)}`;
                document.getElementById('label-normal').classList.remove('hidden');
                document.getElementById('label-desc').innerText = discountInfo.reason;
                document.getElementById('label-desc').classList.remove('hidden');
            } else {
                document.getElementById('label-normal').classList.add('hidden');
                document.getElementById('label-desc').classList.add('hidden');
            }
        }

        function getGPS() {
            const btn = document.getElementById('gpsBtn');
            btn.innerText = "OBTENIENDO...";
            navigator.geolocation.getCurrentPosition(pos => {
                gpsUrl = `https://www.google.com/maps?q=${pos.coords.latitude},${pos.coords.longitude}`;
                btn.innerText = "¬°UBICACI√ìN LISTA! ‚úÖ";
                btn.classList.replace('bg-gradient-to-r', 'bg-green-600');
            }, () => {
                alert("No pudimos obtener tu GPS. Por favor escribe tu direcci√≥n detallada.");
                btn.innerText = "ERROR AL OBTENER GPS";
            });
        }

        // --- Flujo de Cierre ---
        function openSummary() {
            if (finalTotal <= 0) return alert("Elige al menos una chicha");
            if (!document.getElementById('nombre').value || !document.getElementById('telefono').value) return alert("Completa tus datos");

            const itemsDiv = document.getElementById('summary-items');
            itemsDiv.innerHTML = "";
            if (cart.p2l) itemsDiv.innerHTML += `<div class="flex justify-between"><span>2 Litros x${cart.p2l}</span><span>S/ ${cart.p2l*9}</span></div>`;
            if (cart.p3l) itemsDiv.innerHTML += `<div class="flex justify-between"><span>3 Litros x${cart.p3l}</span><span>S/ ${cart.p3l*13}</span></div>`;
            if (cart.p4l) itemsDiv.innerHTML += `<div class="flex justify-between"><span>Gal√≥n 4L x${cart.p4l}</span><span>S/ ${cart.p4l*15}</span></div>`;
            itemsDiv.innerHTML += `<div class="flex justify-between text-zinc-500"><span>Env√≠o</span><span>S/ ${document.getElementById('distrito').value}</span></div>`;
            itemsDiv.innerHTML += `<div class="flex justify-between font-bold text-yellow-500 text-lg border-t border-zinc-800 pt-2 mt-2"><span>TOTAL</span><span>S/ ${finalTotal.toFixed(2)}</span></div>`;

            if (currentMethod !== 'Efectivo') {
                document.getElementById('digital-area').classList.remove('hidden');
                document.getElementById('btnFinal').classList.add('step-inactive');
            } else {
                document.getElementById('digital-area').classList.add('hidden');
                document.getElementById('btnFinal').classList.remove('step-inactive');
            }

            document.getElementById('summaryModal').style.display = 'flex';
        }

        function confirmDigitalPayment() {
            confirmedDigital = true;
            document.getElementById('btnConfirmPay').innerText = "PAGO CONFIRMADO ‚úÖ";
            document.getElementById('btnConfirmPay').classList.add('bg-green-600/20', 'text-green-500');
            document.getElementById('btnFinal').classList.remove('step-inactive');
        }

        async function submitOrder() {
            const nombre = document.getElementById('nombre').value;
            const tel = document.getElementById('telefono').value;
            const dir = document.getElementById('direccion').value;
            const dist = document.getElementById('distrito').options[document.getElementById('distrito').selectedIndex].text;

            const orderId = await window.saveOrder({
                nombre, telefono: tel, direccion: dir, distrito: dist,
                items: cart, total: finalTotal, pago: currentMethod, gps: gpsUrl
            });

            if (!orderId) return alert("Error al conectar. Intenta de nuevo.");

            // WhatsApp Message
            const detalle = `${cart.p2l ? '‚Ä¢ 2L: '+cart.p2l+'\n' : ''}${cart.p3l ? '‚Ä¢ 3L: '+cart.p3l+'\n' : ''}${cart.p4l ? '‚Ä¢ 4L: '+cart.p4l+'\n' : ''}`;
            const msg = `üåΩ *PEDIDO ASWA*\n\nüë§ *Cliente:* ${nombre}\nüì± *Cel:* ${tel}\nüìç *Zona:* ${dist}\nüè† *Direcci√≥n:* ${dir}\n${gpsUrl ? 'üåç *GPS:* '+gpsUrl+'\n' : ''}\nüõí *Detalle:*\n${detalle}üí≥ *Pago:* ${currentMethod}${confirmedDigital ? ' (Pagado ‚úÖ)' : ''}\nüí∞ *Total:* S/ ${finalTotal.toFixed(2)}\n\n_Enviado desde la Web_`;

            window.open(`https://wa.me/51986445531?text=${encodeURIComponent(msg)}`, '_blank');
            setTimeout(() => {
                document.getElementById('summaryModal').style.display = 'none';
                document.getElementById('successScreen').classList.remove('hidden');
                lucide.createIcons();
            }, 500);
        }

        function copyNumber() {
            navigator.clipboard.writeText("986445531");
            alert("N√∫mero copiado");
        }

        function closeModal() { document.getElementById('summaryModal').style.display = 'none'; }

        function shareSocial(network) {
            const text = "¬°Acabo de pedir la mejor chicha de Tarapoto en ASWA! üåΩ Altamente recomendada.";
            if (network === 'fb') window.open(`https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(location.href)}&quote=${encodeURIComponent(text)}`);
            if (network === 'ig') alert("Copia una captura de tu pedido y etiqu√©tanos como @aswa.laricachicha para tu descuento.");
        }

        function handleLogoClick() {
            clicksLogo++;
            if (clicksLogo >= 5) {
                alert("Modo Administrador: Aqu√≠ ir√≠a el panel de gesti√≥n.");
                clicksLogo = 0;
            }
            setTimeout(() => clicksLogo = 0, 5000);
        }
    </script>
</body>
</html>
