<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>La Rica Chicha - ASWA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Bebas+Neue&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-app.js";
        import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.1.0/firebase-auth.js";

        const firebaseConfig = JSON.parse(__firebase_config);
        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'aswa-laricachicha';

        window.db = db;
        window.appId = appId;
        window.currentUser = null;

        const initAuth = async () => {
            try {
                await signInAnonymously(auth);
            } catch (err) {
                console.warn("Auth error:", err);
            }
        };

        onAuthStateChanged(auth, (user) => {
            window.currentUser = user;
        });

        initAuth();

        window.saveOrder = async (orderData) => {
            if (!window.currentUser) return null;
            try {
                const colRef = collection(db, 'artifacts', appId, 'public', 'data', 'pedidos');
                const docRef = await addDoc(colRef, {
                    ...orderData,
                    fecha: serverTimestamp(),
                    uid: window.currentUser.uid
                });
                return docRef.id;
            } catch (err) {
                console.error("Error guardando pedido:", err);
                return null;
            }
        };
    </script>

    <style>
        body { font-family: 'Poppins', sans-serif; background:#0a0a0b; color:white; -webkit-tap-highlight-color:transparent; }
        .font-bebas { font-family: 'Bebas Neue', cursive; }
        .input-dark { background:#121214; border:1px solid #27272a; color:white; transition:border-color .3s; }
        .input-dark:focus { border-color:#facc15; outline:none; }
        .location-btn { background: linear-gradient(to right, #facc15, #eab308); color:#000; font-weight: 800; }
        .location-btn:active { transform: scale(0.98); opacity: 0.9; }
        .success-overlay { display:none; position:fixed; inset:0; background:#000; z-index:3000; flex-direction:column; align-items:center; justify-content:center; text-align:center; padding:20px; }

        /* Mejora centrado de im谩genes */
        .product-img-wrapper {
            width: 100px;
            height: 100px;
            background: #1a1a1a;
            border-radius: 16px;
            border: 1px solid #333;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        .product-img-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: contain;          /* Mantiene proporci贸n sin cortar */
            object-position: center;      /* Centrado perfecto */
            display: block;
        }
    </style>
</head>
<body class="pb-32">

    <!-- Header -->
    <header class="p-6 text-center border-b border-zinc-800 bg-zinc-900/50 backdrop-blur-xl sticky top-0 z-50">
        <h1 class="text-4xl font-bebas text-yellow-400 tracking-tighter">ASWA PREMIUM </h1>
        <p class="text-zinc-500 text-[10px] uppercase tracking-widest font-bold">Chicha Morada Artesanal</p>
    </header>

    <main class="max-w-md mx-auto p-6 space-y-8">
       
        <!-- Productos -->
        <section class="space-y-4">
            <h2 class="text-sm font-bold text-zinc-400 uppercase tracking-widest">Selecciona tu pedido</h2>
           
            <div class="bg-zinc-900 p-4 rounded-3xl border border-zinc-800 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="product-img-wrapper">
                        <img src="aswa de 2 litros 1.png" alt="Aswa 2L">
                    </div>
                    <div>
                        <h3 class="font-bold">Aswa 2 Litros</h3>
                        <p class="text-yellow-400 font-bebas text-xl">S/ 15.00</p>
                    </div>
                </div>
                <div class="flex items-center gap-4 bg-black/40 p-2 rounded-2xl">
                    <button type="button" onclick="updateQty('p2l', -1)" class="w-8 h-8 rounded-lg bg-zinc-800 flex items-center justify-center text-white">-</button>
                    <span id="q-p2l" class="font-bold w-6 text-center">0</span>
                    <button type="button" onclick="updateQty('p2l', 1)" class="w-8 h-8 rounded-lg bg-yellow-500 text-black flex items-center justify-center">+</button>
                </div>
            </div>

            <div class="bg-zinc-900 p-4 rounded-3xl border border-zinc-800 flex items-center justify-between">
                <div class="flex items-center gap-4">
                    <div class="product-img-wrapper">
                        <img src="aswa de 3 litros.png" alt="Aswa 3L">
                    </div>
                    <div>
                        <h3 class="font-bold">Aswa 3 Litros</h3>
                        <p class="text-yellow-400 font-bebas text-xl">S/ 22.00</p>
                    </div>
                </div>
                <div class="flex items-center gap-4 bg-black/40 p-2 rounded-2xl">
                    <button type="button" onclick="updateQty('p3l', -1)" class="w-8 h-8 rounded-lg bg-zinc-800 flex items-center justify-center text-white">-</button>
                    <span id="q-p3l" class="font-bold w-6 text-center">0</span>
                    <button type="button" onclick="updateQty('p3l', 1)" class="w-8 h-8 rounded-lg bg-yellow-500 text-black flex items-center justify-center">+</button>
                </div>
            </div>

            <!-- Agrega el de 4L si lo tienes -->
            <!-- ... -->
        </section>

        <!-- ... (resto del formulario: datos, pago, etc.) ... -->

        <!-- Ubicaci贸n GPS -->
        <div class="relative">
            <textarea id="direccion" rows="3" placeholder="Escribe tu direcci贸n o usa el GPS abajo..." required class="w-full p-4 rounded-2xl input-dark text-sm"></textarea>
           
            <button type="button" onclick="getLocation()" class="location-btn w-full mt-3 py-4 rounded-2xl flex items-center justify-center gap-3 shadow-xl shadow-yellow-500/10">
                <i data-lucide="map-pin" class="w-6 h-6"></i>
                ENVIAR MI UBICACIN GPS ACTUAL
            </button>
            <p id="geoStatus" class="text-[10px] text-zinc-500 mt-2 text-center italic"></p>
        </div>

        <!-- ... (resto del HTML) ... -->
    </main>

    <!-- Barra de pedido y 茅xito igual -->

    <script>
        // ... (todo el JavaScript anterior) ...

        // Funci贸n getLocation ya incluida en tu c贸digo, solo aseg煤rate de que use object-fit correctamente
    </script>
</body>
</html>
